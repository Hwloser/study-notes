# Linux 系统结构详解

内核、shell、文件系统和应用程序构成了linux系统。

内核、shell和文件系统一起构建了基本的操作系统，他们使得用户可以运行，管理文件并使用操作系统。

![Image for post](Linux%20%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84%E8%AF%A6%E8%A7%A3.assets/0_r2bsQonFh-DeBULL_%20(1).jpeg)

## linux 内核

内核时操作系统的核心，她负责管理操作系统的进程、内存、设备驱动程序、文件和网络系统，并决定这操作系统的性能和稳定性。

linux内核由如下几部分构成：内存管理、进程管理、设备驱动程序、文件系统和网络管理等。

![](Linux%20%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84%E8%AF%A6%E8%A7%A3.assets/0_zw-lJaY1rFlk9V5t_.jpeg)

## 内存管理

linux采取了称为“虚拟内存”的管理方式。将内存划分为容易处理的”内存页“（4kb）。

Linux 提供了对 4KB 缓冲区的抽象，例如 slab 分配器。这种内存管理模式使用 4KB 缓冲区为基数，然后从中分配结构，并跟踪内存页使用情况，比如哪些内存页是满的，哪些页面没有完全使用，哪些页面为空。这样就允许该模式根据系统需要来动态调整内存使用。

为了支持多个用户使用内存，有时会出现可用内存被消耗光的情况。由于这个原因，页面可以移出内存并放入磁盘中。这个过程称为交换，因为页面会被从内存交换到硬盘上。内存管理的源代码可以在 ./linux/mm 中找到。

## 进程管理

进程实际是某一applicaiton的运行实体。linux通过时间片来交替运行这些进程，被称之为进程调度，完成调度的程序被称之为调度程序。

每个进程由自己单独的地址空间，并且只能由这一进程访问，用于避免了进程之间的互相干扰以及“坏”程序对系统可能造成的危害。 

操作系统还提供进程间的通讯机制来帮助完成这样的任务。Linux 中常见的进程间通讯机制有信号、管道、共享内存、信号量和套接字等。

## 文件系统

Linux 操作系统将独立的文件系统组合成了一个层次化的树形结构，并且由一个单独的实体代表这一文件系统。

Linux 将新的文件系统通过挂载的方式装在到目录文件上。

虚拟文件系统（VFS）：颖仓了各种硬件的具体细节，把文件系统擦欧总和不同系统的具体实现细节分离。并提供统一的接口为设备。

# 设备驱动程序

设备驱动程序是 Linux 内核的主要部分。和操作系统的其它部分类似，设备驱动程序运行在高特权级的处理器环境中，从而可以直接对硬件进行操作，但正因为如此，任何一个设备驱动程序的错误都可能导致操作系统的崩溃。设备驱动程序实际控制操作系统和硬件设备之间的交互。

设备驱动程序提供一组操作系统可理解的抽象接口完成和操作系统之间的交互，而与硬件相关的具体操作细节由设备驱动程序完成。一般而言，设备驱动程序和设备的控制芯片有关，例如，如果计算机硬盘是 SCSI 硬盘，则需要使用 SCSI 驱动程序，而不是 IDE 驱动程序。

## 网络接口

提供了对各种网络标准的存取和各种网络硬件的支持。网络接口可分为网络协议和网络驱动程序。网络协议部分负责实现每一种可能的网络传输协议。众所周知，TCP/IP 协议是 Internet 的标准协议，同时也是事实上的工业标准。

Linux 的网络实现支持 BSD 套接字，支持全部的TCP/IP协议。Linux内核的网络部分由BSD套接字、网络协议层和网络设备驱动程序组成。网络设备驱动程序负责与硬件设备通讯，每一种可能的硬件设备都有相应的设备驱动程序。

## linux shell

shell是系统的用户界面，提供了用户与内核进行交互操作的一种接口。它接收用户输入的命令并把它送入内核去执行，是一个命令解释器。另外，shell编程语言具有普通编程语言的很多特点，用这种编程语言编写的shell程序与其他应用程序具有同样的效果。

## 文件类型

1. 普通文件：C语言元代码、SHELL脚本、二进制的可执行文件等。分为纯文本和二进制。
2. 目录文件：目录，存储文件的唯一地方。
3. 链接文件：指向同一个文件或目录的的文件。
4. 设备文件：与系统外设相关的，通常在/dev下面。分为块设备和字符设备。
5. 管道(FIFO)文件 : 提供进程建通信的一种方式。
6. 套接字(socket) 文件： 该文件类型与网络通信有关。

## Linux目录

文件结构是文件存放在磁盘等存贮设备上的组织方法。主要体现在对文件和目录的组织上。

目录提供了管理文件的一个方便而有效的途径。

Linux使用标准的目录结构，在安装的时候，安装程序就已经为用户创建了文件系统和完整而固定的目录组成形式，并指定了每个目录的作用和其中的文件类型。

完整的目录树可划分为小的部分，这些小部分又可以单独存放在自己的磁盘或分区上。这样，相对稳定的部分和经常变化的部分可单独存放在不同的分区中，从而方便备份或系统管理。目录树的主要部分有 root、/usr、/var、/home 等（图2） 。这样的布局可方便在 Linux 计算机之间共享文件系统的某些部分。